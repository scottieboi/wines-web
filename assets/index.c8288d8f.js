var le=Object.defineProperty,se=Object.defineProperties;var ie=Object.getOwnPropertyDescriptors;var H=Object.getOwnPropertySymbols;var ce=Object.prototype.hasOwnProperty,pe=Object.prototype.propertyIsEnumerable;var Q=(e,n,a)=>n in e?le(e,n,{enumerable:!0,configurable:!0,writable:!0,value:a}):e[n]=a,c=(e,n)=>{for(var a in n||(n={}))ce.call(n,a)&&Q(e,a,n[a]);if(H)for(var a of H(n))pe.call(n,a)&&Q(e,a,n[a]);return e},p=(e,n)=>se(e,ie(n));import{c as V,a as de,b as ue,m as W,u as me,r as t,C as ge,A as xe,d as R,T as Ee,I,e as fe,f as G,g as ye,D as he,h as ve,i as be,L as Ne,j as we,k as Fe,l as Te,n as Se,o as ke,P as Ce,p as We,q as Be,s as N,t as _,v as Ie,w as Ae,x as Pe,y as qe,z as Oe,B as Re,E as Le,F as $e,G as ze,H as $,J as z,K as C,M as d,N as M,O as Me,Q as Ve,R as Ge,S as K,U as _e,V as J,W as je}from"./vendor.27e734df.js";const He=function(){const n=document.createElement("link").relList;if(n&&n.supports&&n.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))l(s);new MutationObserver(s=>{for(const o of s)if(o.type==="childList")for(const i of o.addedNodes)i.tagName==="LINK"&&i.rel==="modulepreload"&&l(i)}).observe(document,{childList:!0,subtree:!0});function a(s){const o={};return s.integrity&&(o.integrity=s.integrity),s.referrerpolicy&&(o.referrerPolicy=s.referrerpolicy),s.crossorigin==="use-credentials"?o.credentials="include":s.crossorigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function l(s){if(s.ep)return;s.ep=!0;const o=a(s);fetch(s.href,o)}};He();const Qe=()=>{var a,l;const e=(a=localStorage.getItem("token"))!=null?a:"{}",n=JSON.parse(e);return(l=n==null?void 0:n.token)!=null?l:null},Ke={token:Qe()},Je=V({name:"Auth",initialState:Ke,reducers:{saveToken(e,n){e.token=n.payload}}});var Ue=Je.reducer;const Ye={loading:!1,response:null},U=V({name:"FindAllWines",initialState:Ye,reducers:{updateFindAllWines(e,n){e.response=n.payload,e.loading=!1},fetchFindAllWines(e){e.loading=!0}}}),{updateFindAllWines:De,fetchFindAllWines:Xe}=U.actions;var Ze=U.reducer;const et={loading:!1,response:null},Y=V({name:"FindWineById",initialState:et,reducers:{updateFindWineById(e,n){e.response=n.payload,e.loading=!1},fetchFindWineById(e){e.loading=!0}}}),{updateFindWineById:tt,fetchFindWineById:nt}=Y.actions;var at=Y.reducer;const rt=de({auth:Ue,findAllWines:Ze,findWineById:at}),ot=ue({reducer:rt});var P=(e=>(e.Dashboard="/",e.AddWine="/addwine",e))(P||{});const L=240,lt=W(e=>({root:{display:"flex"},toolbar:{paddingRight:24},toolbarIcon:c({display:"flex",alignItems:"center",justifyContent:"flex-end",padding:"0 8px"},e.mixins.toolbar),appBar:{zIndex:e.zIndex.drawer+1,transition:e.transitions.create(["width","margin"],{easing:e.transitions.easing.sharp,duration:e.transitions.duration.leavingScreen})},appBarShift:{marginLeft:L,width:`calc(100% - ${L}px)`,transition:e.transitions.create(["width","margin"],{easing:e.transitions.easing.sharp,duration:e.transitions.duration.enteringScreen})},menuButton:{marginRight:36},menuButtonHidden:{display:"none"},title:{flexGrow:1},drawerPaper:{position:"relative",whiteSpace:"nowrap",width:L,transition:e.transitions.create("width",{easing:e.transitions.easing.sharp,duration:e.transitions.duration.enteringScreen})},drawerPaperClose:{overflowX:"hidden",transition:e.transitions.create("width",{easing:e.transitions.easing.sharp,duration:e.transitions.duration.leavingScreen}),width:e.spacing(7),[e.breakpoints.up("sm")]:{width:e.spacing(9)}},appBarSpacer:e.mixins.toolbar,content:{flexGrow:1,height:"100vh",overflow:"auto"},container:{paddingTop:e.spacing(4),paddingBottom:e.spacing(4)},paper:{padding:e.spacing(2),display:"flex",overflow:"auto",flexDirection:"column"},fixedHeight:{height:240}})),st=e=>{const n=lt(),a=me(),l=()=>{a(P.AddWine)},s=()=>{a(P.Dashboard)},[o,i]=t.exports.useState(!1),m=()=>{i(!0)},y=()=>{i(!1)},{titleText:g}=e;return t.exports.createElement(t.exports.Fragment,null,t.exports.createElement(ge,null),t.exports.createElement(xe,{position:"absolute",className:R(n.appBar,o&&n.appBarShift)},t.exports.createElement(Ee,{className:n.toolbar},t.exports.createElement(I,{edge:"start",color:"inherit","aria-label":"open drawer",onClick:m,className:R(n.menuButton,o&&n.menuButtonHidden)},t.exports.createElement(fe,null)),t.exports.createElement(G,{component:"h1",variant:"h6",color:"inherit",noWrap:!0,className:n.title},g),t.exports.createElement(I,{color:"inherit","aria-label":"add a wine",onClick:l},t.exports.createElement(ye,null)))),t.exports.createElement(he,{variant:"permanent",classes:{paper:R(n.drawerPaper,!o&&n.drawerPaperClose)},open:o},t.exports.createElement("div",{className:n.toolbarIcon},t.exports.createElement(I,{onClick:y},t.exports.createElement(ve,null))),t.exports.createElement(be,null),t.exports.createElement(Ne,null,t.exports.createElement(we,{button:!0,onClick:s},t.exports.createElement(Fe,null,t.exports.createElement(Te,null)),t.exports.createElement(Se,{primary:"Dashboard"})))))},it=W(e=>({root:{display:"flex"},appBarSpacer:e.mixins.toolbar,content:{flexGrow:1,height:"100vh",overflow:"auto"},container:{paddingTop:e.spacing(4),paddingBottom:e.spacing(4)},paper:{padding:e.spacing(2),display:"flex",overflow:"auto",flexDirection:"column"}})),D=({children:e,titleText:n})=>{const a=it();return t.exports.createElement("div",{className:a.root},t.exports.createElement(st,{titleText:n}),t.exports.createElement("main",{className:a.content},t.exports.createElement("div",{className:a.appBarSpacer}),t.exports.createElement(ke,{maxWidth:"lg",className:a.container},t.exports.createElement(t.exports.Fragment,null,e))))},ct=W(e=>({paper:{padding:e.spacing(2),display:"flex",overflow:"auto",flexDirection:"column"}})),X=({children:e})=>{const n=ct();return t.exports.createElement(Ce,{className:n.paper},t.exports.createElement(t.exports.Fragment,null,e))},A=({children:e,subtitle:n,className:a})=>t.exports.createElement(G,{className:a,component:"h2",variant:n?"subtitle1":"h6",color:"primary",gutterBottom:!0},e);A.defaultProps={subtitle:!1,className:void 0};const pt=We(),O=({label:e,className:n,onFetchOptions:a,value:l,onUpdateValue:s,required:o,error:i,helperText:m})=>{const[y,g]=t.exports.useState([]),[v,h]=t.exports.useState(!1),b=v&&y.length===0;return t.exports.useEffect(()=>{let x=!0;if(!!b)return(async()=>{if(x){const E=await a();g(E)}})(),()=>{x=!1}},[b,a,l]),t.exports.createElement(Be,{selectOnFocus:!0,clearOnBlur:!0,handleHomeEndKeys:!0,value:l,onChange:(x,E)=>{typeof E=="string"?s({name:E}):E&&E.inputValue?s({name:E.inputValue}):s(E)},style:{display:"inline-flex"},className:n,options:y,open:v,onOpen:()=>{h(!0)},onClose:()=>{h(!1)},filterOptions:(x,E)=>{const w=pt(x,E);return E.inputValue!==""&&w.push({inputValue:E.inputValue,name:`Add "${E.inputValue}"`}),w},getOptionLabel:x=>typeof x=="string"?x:x.inputValue?x.inputValue:x.name,freeSolo:!0,renderOption:x=>x.name,loading:b,renderInput:x=>t.exports.createElement(N,p(c({},x),{required:o,error:i,helperText:m,label:e,InputProps:p(c({},x.InputProps),{endAdornment:t.exports.createElement(t.exports.Fragment,null,b&&t.exports.createElement(_,{color:"inherit",size:20}),x.InputProps.endAdornment)})}))})};O.defaultProps={className:void 0,required:!1,error:!1,helperText:void 0};const B=Ie.create({baseURL:String("https://localhost:5001"),responseType:"json",headers:{"Content-Type":"application/json"}});function dt(e,n){return B.post("wine",n)}function ut(e){return B.get("/wines")}function mt(e,n){return B.get("/wine",{params:{id:n.toString()}})}function gt(e,n){return B.get("/vineyard",{params:{searchterm:n}})}function xt(e,n){return B.get("/region",{params:{searchterm:n}})}function Et(e,n){return B.get("/winetype",{params:{searchterm:n}})}const Z=()=>Ae(),F=Pe;function ft(){const e=F(n=>n.auth.token);return async n=>{if(e)return(await xt(e,n!=null?n:"")).data}}function yt(){const e=F(n=>n.auth.token);return async n=>{if(e)return(await gt(e,n!=null?n:"")).data}}function ht(){const e=F(n=>n.auth.token);return async n=>{if(e)return(await Et(e,n!=null?n:"")).data}}function vt(){const e=F(n=>n.auth.token);return async n=>e?(await dt(e,n),!0):!1}const ee=({locations:e,onUpdateLocations:n,textFieldClassName:a,validationMessages:l})=>{const s=()=>{n({addLocation:!0})},o=()=>{e.length>1&&n({removeLocation:!0})},i=(y,g,v)=>{const h=g===""?"":Number.parseInt(g,10);n({newLocation:{newValue:!Number.isNaN(h)&&h!==0?h:e[v][y],locationId:v,type:y}})},m=(y,g)=>{const v=l&&l[g]?l[g].boxno:void 0,h=l&&l[g]?l[g].qty:void 0;return t.exports.createElement(t.exports.Fragment,null,t.exports.createElement(N,{error:!!v,helperText:v,required:!0,value:y.boxno,onChange:b=>i("boxno",b.target.value,g),label:"Box no.",className:a}),t.exports.createElement(N,{error:!!h,helperText:h,required:!0,value:y.qty,onChange:b=>i("qty",b.target.value,g),label:"Quantity",className:a}))};return t.exports.createElement(t.exports.Fragment,null,t.exports.createElement("div",null,t.exports.createElement(I,{color:"inherit","aria-label":"add a location",onClick:s},t.exports.createElement(qe,{style:{marginRight:"0.5em"}}),t.exports.createElement(G,{variant:"body1",component:"span"},"Add a new location"))),e.map((y,g)=>t.exports.createElement("div",{key:g},m(y,g),g===e.length-1&&t.exports.createElement(I,{color:"inherit","aria-label":"remove last location",onClick:o},t.exports.createElement(Oe,null)))))};ee.defaultProps={textFieldClassName:void 0,validationMessages:void 0};function bt(e){var o,i,m,y,g,v,h,b,x,E,w;const n="Missing required field";let a={};const l=[];e.wineName||(a=p(c({},a),{wineName:n})),((o=e.vineyard)==null?void 0:o.name)||(a=p(c({},a),{vineyard:n})),((i=e.wineType)==null?void 0:i.name)||(a=p(c({},a),{wineType:n})),((m=e.region)==null?void 0:m.name)||(a=p(c({},a),{region:n})),e.vintage||(a=p(c({},a),{vintage:n})),e.locations.forEach((T,S)=>{T.boxno||(l[S]=p(c({},l[S]),{boxno:n})),T.qty||(l[S]=p(c({},l[S]),{qty:n}))}),l.length>0&&(a=p(c({},a),{locations:l}));let s=null;return Object.keys(a).length===0&&(s={wineName:e.wineName,vineyard:(g=(y=e.vineyard)==null?void 0:y.name)!=null?g:"",wineType:(h=(v=e.wineType)==null?void 0:v.name)!=null?h:"",region:(x=(b=e.region)==null?void 0:b.name)!=null?x:"",vintage:e.vintage===""?0:e.vintage,locations:e.locations.map(T=>({boxNo:T.boxno===""?NaN:T.boxno,qty:T.qty===""?NaN:T.qty})),notes:e.notes,yearBought:e.yearBought===""?void 0:e.yearBought,drinkFrom:e.drinkFrom===""?void 0:e.drinkFrom,drinkTo:e.drinkTo===""?void 0:e.drinkTo,pricePaid:(E=Number.parseFloat(e.pricePaid))!=null?E:void 0,rating:e.rating===""?void 0:e.rating,percentAlcohol:(w=Number.parseFloat(e.percentAlcohol))!=null?w:void 0,bottleSize:e.bottleSize===""?void 0:e.bottleSize}),{errors:a,validatedModel:s}}const Nt=W(e=>{const n=e.spacing(1);return{form:{maxWidth:"800px"},formGroup:{marginBottom:e.spacing(1)},formGroupTitle:{marginTop:e.spacing(4)},textField:{marginLeft:n,marginRight:n,width:"30ch"},notesField:{marginLeft:n,marginRight:n,width:`calc(100% - ${n*2}px)`},submitBtnContainer:{marginTop:e.spacing(4),display:"flex"},doneIcon:{marginLeft:n}}}),wt=()=>{const e=Nt(),[n,a]=t.exports.useState({wineName:"",notes:"",vintage:"",yearBought:"",drinkFrom:"",drinkTo:"",pricePaid:"",rating:"",percentAlcohol:"",bottleSize:"",wineType:null,vineyard:null,region:null,locations:[{qty:"",boxno:""}]}),[l,s]=t.exports.useState(0),[o,i]=t.exports.useState({}),m=vt(),y=yt(),g=async()=>{var u;const r=await y();return(u=r==null?void 0:r.map(f=>({name:f.vineyard,id:f.id})))!=null?u:[]},v=ht(),h=async()=>{var u;const r=await v();return(u=r==null?void 0:r.map(f=>({name:f.wineType,id:f.id})))!=null?u:[]},b=ft(),x=async()=>{var u;const r=await b();return(u=r==null?void 0:r.map(f=>({name:f.region,id:f.id})))!=null?u:[]},E=(r,u)=>{i(p(c({},o),{[r]:void 0}));const f=u===""?"":Number.parseInt(u,10);(f===""||/^\d{0,4}$/.test(u))&&a(p(c({},n),{[r]:f}))},w=(r,u)=>{i(p(c({},o),{[r]:void 0})),a(p(c({},n),{[r]:u}))},T=r=>{(r===""||/^\d*\.?\d{0,2}$/.test(r))&&a(p(c({},n),{pricePaid:r}))},S=r=>{const u=r===""?"":Number.parseInt(r,10);(u===""||/^\d{0,3}$/.test(r))&&a(p(c({},n),{rating:u}))},ne=r=>{(r===""||/^\d{0,2}\.?\d{0,1}$/.test(r))&&a(p(c({},n),{percentAlcohol:r}))},ae=r=>{const u=r===""?"":Number.parseInt(r,10);(u===""||!Number.isNaN(u))&&a(p(c({},n),{bottleSize:u}))},re=({addLocation:r,removeLocation:u,newLocation:f})=>{let k=[...n.locations];if(r)k.push({boxno:"",qty:""});else if(u){const q=k.length-1;if(o.locations&&o.locations[q]){const j=c({},o.locations);delete j[q],i(p(c({},o),{locations:j}))}k=n.locations.slice(0,-1)}else if(f){if(o.locations&&o.locations[f.locationId]){const q=p(c({},o.locations),{[f.locationId]:p(c({},o.locations[f.locationId]),{[f.type]:void 0})});i(p(c({},o),{locations:q}))}k[f.locationId]=p(c({},k[f.locationId]),{[f.type]:f.newValue})}a(p(c({},n),{locations:k}))},oe=async()=>{const r=bt(n);i(r.errors),r.validatedModel!==null&&(s(1),await m(r.validatedModel),s(2))};return t.exports.createElement(D,{titleText:"Add a wine"},t.exports.createElement(X,null,t.exports.createElement(A,null,"New wine"),t.exports.createElement("form",{className:e.form,noValidate:!0,autoComplete:"off"},t.exports.createElement("div",{className:e.formGroup},t.exports.createElement(N,{required:!0,error:!!o.wineName,helperText:o.wineName,label:"Wine name",className:e.textField,value:n.wineName,onChange:r=>w("wineName",r.target.value)}),t.exports.createElement(O,{required:!0,error:!!o.vineyard,helperText:o.vineyard,label:"Vineyard",className:e.textField,onFetchOptions:g,value:n.vineyard,onUpdateValue:r=>w("vineyard",r)}),t.exports.createElement(O,{required:!0,error:!!o.wineType,helperText:o.wineType,label:"Wine type",className:e.textField,onFetchOptions:h,value:n.wineType,onUpdateValue:r=>w("wineType",r)}),t.exports.createElement(O,{required:!0,error:!!o.region,helperText:o.region,label:"Region",className:e.textField,onFetchOptions:x,value:n.region,onUpdateValue:r=>w("region",r)}),t.exports.createElement(N,{required:!0,error:!!o.vintage,helperText:o.vintage,label:"Vintage",className:e.textField,value:n.vintage,onChange:r=>E("vintage",r.target.value)})),t.exports.createElement("div",{className:e.formGroup},t.exports.createElement(A,{subtitle:!0,className:e.formGroupTitle},"More details"),t.exports.createElement(N,{label:"Year bought",className:e.textField,value:n.yearBought,onChange:r=>E("yearBought",r.target.value)}),t.exports.createElement(N,{label:"Drink from (year)",className:e.textField,value:n.drinkFrom,onChange:r=>E("drinkFrom",r.target.value)}),t.exports.createElement(N,{label:"Drink to (year)",className:e.textField,value:n.drinkTo,onChange:r=>E("drinkTo",r.target.value)}),t.exports.createElement(N,{label:"Price paid",className:e.textField,value:n.pricePaid,onChange:r=>T(r.target.value)}),t.exports.createElement(N,{label:"Rating",className:e.textField,value:n.rating,onChange:r=>S(r.target.value)}),t.exports.createElement(N,{label:"Bottle size",className:e.textField,value:n.bottleSize,onChange:r=>ae(r.target.value)}),t.exports.createElement(N,{label:"Percent alcohol",className:e.textField,value:n.percentAlcohol,onChange:r=>ne(r.target.value)}),t.exports.createElement(N,{label:"Notes",multiline:!0,className:e.notesField,value:n.notes,onChange:r=>w("notes",r.target.value)})),t.exports.createElement("div",null,t.exports.createElement(A,{subtitle:!0,className:e.formGroupTitle},"Location in cellar"),t.exports.createElement(ee,{locations:n.locations,validationMessages:o.locations,onUpdateLocations:re,textFieldClassName:e.textField})),t.exports.createElement("div",{className:e.submitBtnContainer},t.exports.createElement(Re,{variant:"contained",color:"primary",disabled:l!==0,onClick:oe,endIcon:l===1&&t.exports.createElement(_,{color:"inherit",size:20})},"Add wine"),l===2&&t.exports.createElement(Le,{color:"primary",fontSize:"large",className:e.doneIcon})))))},Ft=W(()=>({progress:{display:"flex",width:"100%",justifyContent:"center"}})),te=()=>{const e=Ft();return t.exports.createElement("div",{className:e.progress},t.exports.createElement(_,null))},Tt=W(e=>({paper:{minWidth:"250px",backgroundColor:e.palette.background.paper,border:"1px solid #000",boxShadow:e.shadows[5],padding:e.spacing(2,4)},table:{marginBottom:e.spacing(2)}})),St=e=>{const{isOpen:n,onClose:a}=e,l=Tt(),s=F(i=>i.findWineById.loading),o=F(i=>i.findWineById.response);return t.exports.createElement($e,{open:n,onClose:a,"aria-labelledby":"simple-modal-title","aria-describedby":"simple-modal-description"},t.exports.createElement("div",{className:l.paper},s||o===null?t.exports.createElement(te,null):t.exports.createElement(t.exports.Fragment,null,t.exports.createElement(ze,null,"Wine details"),t.exports.createElement($,{size:"small",className:l.table},t.exports.createElement(z,null,t.exports.createElement(C,null,t.exports.createElement(d,null,"Wine name"),t.exports.createElement(d,null,"Wine type"),t.exports.createElement(d,null,"Vineyard"),t.exports.createElement(d,null,"Vintage"),t.exports.createElement(d,{align:"right"},"Quantity"))),t.exports.createElement(M,null,t.exports.createElement(C,{key:o.id},t.exports.createElement(d,null,o.wineName),t.exports.createElement(d,null,o.wineType),t.exports.createElement(d,null,o.vineyard),t.exports.createElement(d,null,o.vintage),t.exports.createElement(d,{align:"right"},o.boxes.reduce((i,m)=>i+m.qty,0))))),t.exports.createElement($,{size:"small",className:l.table},t.exports.createElement(z,null,t.exports.createElement(C,null,t.exports.createElement(d,{align:"right"},"Box Number"),t.exports.createElement(d,{align:"right"},"Quantity"))),t.exports.createElement(M,null,o.boxes.map(i=>t.exports.createElement(C,{key:i.boxNo},t.exports.createElement(d,{align:"right"},i.boxNo),t.exports.createElement(d,{align:"right"},i.qty))))))))};function kt(){const e=Z(),n=F(l=>l.auth.token);return()=>{n&&(e(Xe()),ut().then(l=>{e(De(l.data))}))}}function Ct(){const e=Z(),n=F(l=>l.auth.token);return l=>{n&&(e(nt()),mt(n,l).then(s=>{e(tt(s.data))}))}}const Wt=e=>{const[n,a]=t.exports.useState(!1),l=Ct(),s=()=>{a(!1)},o=m=>{a(!0),l(m)},{data:i}=e;return t.exports.createElement(t.exports.Fragment,null,t.exports.createElement(St,{isOpen:n,onClose:s}),t.exports.createElement($,{size:"small"},t.exports.createElement(z,null,t.exports.createElement(C,null,t.exports.createElement(d,null,"Vineyard"),t.exports.createElement(d,null,"Wine name"),t.exports.createElement(d,null,"Wine type"),t.exports.createElement(d,null,"Vintage"),t.exports.createElement(d,{align:"right"},"Quantity"))),t.exports.createElement(M,null,i.map(m=>t.exports.createElement(C,{key:m.id},t.exports.createElement(d,null,t.exports.createElement(Me,{onClick:()=>o(m.id)},m.vineyard)),t.exports.createElement(d,null,m.wineName),t.exports.createElement(d,null,m.wineType),t.exports.createElement(d,null,m.vintage),t.exports.createElement(d,{align:"right"},m.qty))))))},Bt=()=>{const[e,n]=t.exports.useState(!0),a=kt(),l=F(o=>o.findAllWines.loading),s=F(o=>o.findAllWines.response);return t.exports.useEffect(()=>{e&&!l&&(a(),n(!1))},[e,l,a]),t.exports.createElement(D,{titleText:"Dashboard"},t.exports.createElement(X,null,t.exports.createElement(A,null,"All wines"),l||s===null?t.exports.createElement(te,null):t.exports.createElement(Wt,{data:s})))};function It(){return t.exports.createElement(Ve,null,t.exports.createElement(Ge,null,t.exports.createElement(K,{path:P.Dashboard,element:t.exports.createElement(Bt,null)}),t.exports.createElement(K,{path:P.AddWine,element:t.exports.createElement(wt,null)})))}const At=document.getElementById("root"),Pt=_e(At);Pt.render(J.createElement(je,{store:ot},J.createElement(It,null)));
